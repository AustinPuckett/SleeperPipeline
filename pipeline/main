import extract
import transform
import load
import os
import time

t0 = time.time()
db = 'fantasy.db'
num_weeks=18

# # Call API to get json data
Extract.extract_all()

# # Transform data from json files and load into database
# api = Load.FantasyApi(db)
# # Load.update_all_tables(api, _overwrite=True)
# table_names = ['league', 'roster', 'rostered_player', 'user', 'nfl_state', 'draft_info', 'draft_order',
#                    'draft_pick', 'league_transaction', 'roster_week', 'player_week', 'player']
# api.update_tables(table_names, _overwrite=True)
# api.conn.close()
#
#
# t3 = time.time()
# print(t3-t2, " seconds to transform and load the data into sqlite3 db.")
# print(t3-t0, " total seconds to complete the entire ETL process.")
